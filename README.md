# La Liga Match Predictor üîÆ‚öΩ

A machine learning-powered football match prediction system that analyzes La Liga matches using advanced statistical modeling and Random Forest algorithms.

## üöÄ Features

- **Advanced Statistical Analysis**: Comprehensive team performance metrics including form, attack/defense ratings, and venue-specific performance
- **Machine Learning Predictions**: Random Forest classifier trained on 2+ seasons of historical data
- **Real-time Data**: Fetches live data from football-data.org API
- **Predictive Insights**: Generates probability-based predictions for upcoming matches
- **Quality Opposition Analysis**: Tracks performance against top and bottom-tier teams

## üìä Current Gameweek Predictions

### Upcoming Gameweek Predictions
*Last Updated: September 27, 2025 at 10:35 UTC*

```
============================================================
PREDICTIONS FOR UPCOMING MATCHES
============================================================

--- GAMEWEEK 7 ---

2025-09-27 16:30
RCD Mallorca vs Deportivo Alav√©s
Prediction: Draw
Probabilities: RCD Mallorca 26.9% | Draw 49.0% | Deportivo Alav√©s 24.0%
Stats: RCD Mallorca PPG: 1.10, Form: 0.40 | Deportivo Alav√©s PPG: 1.17, Form: 1.00
2025-09-27 19:00
Villarreal CF vs Athletic Club
Prediction: Villarreal CF Win
Probabilities: Villarreal CF 44.8% | Draw 29.7% | Athletic Club 25.5%
Stats: Villarreal CF PPG: 1.66, Form: 2.00 | Athletic Club PPG: 1.80, Form: 1.40
2025-09-28 12:00
Rayo Vallecano de Madrid vs Sevilla FC
Prediction: Rayo Vallecano de Madrid Win
Probabilities: Rayo Vallecano de Madrid 40.3% | Draw 39.2% | Sevilla FC 20.5%
Stats: Rayo Vallecano de Madrid PPG: 1.16, Form: 0.40 | Sevilla FC PPG: 1.09, Form: 1.40
2025-09-28 14:15
Elche CF vs RC Celta de Vigo
Prediction: Elche CF Win
Probabilities: Elche CF 59.5% | Draw 29.7% | RC Celta de Vigo 10.8%
Stats: Elche CF PPG: 1.67, Form: 1.80 | RC Celta de Vigo PPG: 1.23, Form: 1.00
2025-09-28 16:30
FC Barcelona vs Real Sociedad de F√∫tbol
Prediction: FC Barcelona Win
Probabilities: FC Barcelona 77.6% | Draw 16.9% | Real Sociedad de F√∫tbol 5.4%
Stats: FC Barcelona PPG: 2.30, Form: 2.60 | Real Sociedad de F√∫tbol PPG: 1.35, Form: 0.80
2025-09-28 19:00
Real Betis Balompi√© vs CA Osasuna
Prediction: CA Osasuna Win
Probabilities: Real Betis Balompi√© 26.1% | Draw 34.9% | CA Osasuna 39.0%
Stats: Real Betis Balompi√© PPG: 1.54, Form: 1.60 | CA Osasuna PPG: 1.27, Form: 1.40
2025-09-29 19:00
Valencia CF vs Real Oviedo
Prediction: Valencia CF Win
Probabilities: Valencia CF 76.2% | Draw 15.9% | Real Oviedo 7.9%
Stats: Valencia CF PPG: 1.26, Form: 1.40 | Real Oviedo PPG: 0.50, Form: 0.60
2025-10-03 19:00
CA Osasuna vs Getafe CF
Prediction: CA Osasuna Win
Probabilities: CA Osasuna 44.2% | Draw 24.5% | Getafe CF 31.3%
Stats: CA Osasuna PPG: 1.27, Form: 1.40 | Getafe CF PPG: 1.16, Form: 1.00
2025-10-04 12:00
Real Oviedo vs Levante UD
Prediction: Draw
Probabilities: Real Oviedo 29.1% | Draw 48.3% | Levante UD 22.6%
Stats: Real Oviedo PPG: 0.50, Form: 0.60 | Levante UD PPG: 0.71, Form: 1.00
2025-10-04 14:15
Girona FC vs Valencia CF
Prediction: Draw
Probabilities: Girona FC 26.3% | Draw 44.0% | Valencia CF 29.7%
Stats: Girona FC PPG: 1.51, Form: 0.60 | Valencia CF PPG: 1.26, Form: 1.40
2025-10-04 16:30
Athletic Club vs RCD Mallorca
Prediction: Athletic Club Win
Probabilities: Athletic Club 51.7% | Draw 32.5% | RCD Mallorca 15.8%
Stats: Athletic Club PPG: 1.80, Form: 1.40 | RCD Mallorca PPG: 1.10, Form: 0.40
2025-10-04 19:00
Real Madrid CF vs Villarreal CF
Prediction: Real Madrid CF Win
Probabilities: Real Madrid CF 61.2% | Draw 24.6% | Villarreal CF 14.2%
Stats: Real Madrid CF PPG: 2.39, Form: 2.60 | Villarreal CF PPG: 1.66, Form: 2.00
2025-10-05 12:00
Deportivo Alav√©s vs Elche CF
Prediction: Draw
Probabilities: Deportivo Alav√©s 17.0% | Draw 48.1% | Elche CF 34.9%
Stats: Deportivo Alav√©s PPG: 1.17, Form: 1.00 | Elche CF PPG: 1.67, Form: 1.80
2025-10-05 14:15
Sevilla FC vs FC Barcelona
Prediction: FC Barcelona Win
Probabilities: Sevilla FC 15.1% | Draw 31.5% | FC Barcelona 53.4%
Stats: Sevilla FC PPG: 1.09, Form: 1.40 | FC Barcelona PPG: 2.30, Form: 2.60
2025-10-05 16:30
Real Sociedad de F√∫tbol vs Rayo Vallecano de Madrid
Prediction: Rayo Vallecano de Madrid Win
Probabilities: Real Sociedad de F√∫tbol 28.6% | Draw 30.6% | Rayo Vallecano de Madrid 40.9%
Stats: Real Sociedad de F√∫tbol PPG: 1.35, Form: 0.80 | Rayo Vallecano de Madrid PPG: 1.16, Form: 0.40
2025-10-05 16:30
RCD Espanyol de Barcelona vs Real Betis Balompi√©
Prediction: Draw
Probabilities: RCD Espanyol de Barcelona 28.4% | Draw 42.5% | Real Betis Balompi√© 29.1%
Stats: RCD Espanyol de Barcelona PPG: 1.20, Form: 1.60 | Real Betis Balompi√© PPG: 1.54, Form: 1.60
2025-10-05 19:00
RC Celta de Vigo vs Club Atl√©tico de Madrid
Prediction: Club Atl√©tico de Madrid Win
Probabilities: RC Celta de Vigo 21.1% | Draw 34.8% | Club Atl√©tico de Madrid 44.2%
Stats: RC Celta de Vigo PPG: 1.23, Form: 1.00 | Club Atl√©tico de Madrid PPG: 1.95, Form: 1.80
2025-10-17 19:00
Real Oviedo vs RCD Espanyol de Barcelona
Prediction: Draw
Probabilities: Real Oviedo 22.0% | Draw 42.1% | RCD Espanyol de Barcelona 35.9%
Stats: Real Oviedo PPG: 0.50, Form: 0.60 | RCD Espanyol de Barcelona PPG: 1.20, Form: 1.60
2025-10-18 12:00
Sevilla FC vs RCD Mallorca
Prediction: Draw
Probabilities: Sevilla FC 32.1% | Draw 46.6% | RCD Mallorca 21.4%
Stats: Sevilla FC PPG: 1.09, Form: 1.40 | RCD Mallorca PPG: 1.10, Form: 0.40
2025-10-18 14:15
FC Barcelona vs Girona FC
Prediction: FC Barcelona Win
Probabilities: FC Barcelona 68.7% | Draw 22.3% | Girona FC 9.1%
Stats: FC Barcelona PPG: 2.30, Form: 2.60 | Girona FC PPG: 1.51, Form: 0.60
2025-10-18 16:30
Villarreal CF vs Real Betis Balompi√©
Prediction: Draw
Probabilities: Villarreal CF 38.5% | Draw 40.8% | Real Betis Balompi√© 20.7%
Stats: Villarreal CF PPG: 1.66, Form: 2.00 | Real Betis Balompi√© PPG: 1.54, Form: 1.60
2025-10-18 19:00
Club Atl√©tico de Madrid vs CA Osasuna
Prediction: Club Atl√©tico de Madrid Win
Probabilities: Club Atl√©tico de Madrid 66.7% | Draw 22.9% | CA Osasuna 10.4%
Stats: Club Atl√©tico de Madrid PPG: 1.95, Form: 1.80 | CA Osasuna PPG: 1.27, Form: 1.40
2025-10-19 12:00
Elche CF vs Athletic Club
Prediction: Elche CF Win
Probabilities: Elche CF 40.3% | Draw 22.4% | Athletic Club 37.3%
Stats: Elche CF PPG: 1.67, Form: 1.80 | Athletic Club PPG: 1.80, Form: 1.40
2025-10-19 14:15
RC Celta de Vigo vs Real Sociedad de F√∫tbol
Prediction: Draw
Probabilities: RC Celta de Vigo 34.9% | Draw 40.5% | Real Sociedad de F√∫tbol 24.6%
Stats: RC Celta de Vigo PPG: 1.23, Form: 1.00 | Real Sociedad de F√∫tbol PPG: 1.35, Form: 0.80
2025-10-19 16:30
Levante UD vs Rayo Vallecano de Madrid
Prediction: Rayo Vallecano de Madrid Win
Probabilities: Levante UD 30.2% | Draw 27.1% | Rayo Vallecano de Madrid 42.8%
Stats: Levante UD PPG: 0.71, Form: 1.00 | Rayo Vallecano de Madrid PPG: 1.16, Form: 0.40
2025-10-19 19:00
Getafe CF vs Real Madrid CF
Prediction: Real Madrid CF Win
Probabilities: Getafe CF 10.5% | Draw 21.9% | Real Madrid CF 67.7%
Stats: Getafe CF PPG: 1.16, Form: 1.00 | Real Madrid CF PPG: 2.39, Form: 2.60
2025-10-20 19:00
Deportivo Alav√©s vs Valencia CF
Prediction: Draw
Probabilities: Deportivo Alav√©s 37.4% | Draw 42.2% | Valencia CF 20.5%
Stats: Deportivo Alav√©s PPG: 1.17, Form: 1.00 | Valencia CF PPG: 1.26, Form: 1.40
```

## üèÜ Model Performance

- **Training Accuracy**: 93.6%
- **Training Dataset**: 823 matches from 2023-2025 seasons
- **Features**: 27 predictive features

### Accuracy by Result Type:
- **Home Wins**: 90.6% (363 matches)
- **Away Wins**: 96.6% (235 matches)  
- **Draws**: 95.1% (225 matches)


## üéØ Current Model Features (Top 10)

1. **Gd Difference**: 0.0774
2. **Overall Strength Diff**: 0.0692
3. **Ppg Difference**: 0.0651
4. **Home Advantage**: 0.0637
5. **Quality Performance Diff**: 0.0612
6. **Margin Difference**: 0.0603
7. **Expected Home Goals**: 0.0517
8. **Attack Vs Defense**: 0.0497
9. **Matchday**: 0.0489
10. **Clean Sheet Advantage**: 0.0455


## üîß Installation & Setup

### Prerequisites
```bash
pip install requests pandas scikit-learn numpy python-dotenv
```

### Environment Setup
1. Get your API key from [football-data.org](https://www.football-data.org/client/register)
2. Create a `.env` file in the project root:
```
FOOTBALL_API_KEY=your_api_key_here
```

### Running the Predictor
```bash
python la_liga_predictor.py
```

## üìà Key Features Explained

### Statistical Metrics
- **PPG (Points Per Game)**: Average points earned per match
- **Form Rating**: Weighted average of recent results (W=3, D=1, L=0)
- **Attack/Defense Ratings**: Goals scored/conceded per game
- **Quality Performance**: Results against top-6 and bottom-6 teams

### Prediction Algorithm
The model uses a Random Forest classifier with:
- **300 estimators** for stability
- **Balanced class weights** to handle draws
- **Feature engineering** combining 25+ metrics
- **Cross-validation** on historical data

## üìã Model Architecture

```
Training Data (2023-2025)
         ‚Üì
Feature Engineering (25+ features)
         ‚Üì
Random Forest Classifier
         ‚Üì
Probability Predictions
         ‚Üì
Match Outcome Predictions
```

## üé≤ Using the Predictions

- **Prediction**: Most likely outcome based on statistical model
- **Probabilities**: Confidence percentages for each possible result  
- **Stats**: Key team metrics (Points Per Game and Recent Form rating)

## üìä Usage Examples

### Basic Prediction
```python
# The script automatically predicts the next upcoming gameweek
python la_liga_predictor.py
```

### Understanding Output
- **Prediction**: Most likely outcome based on model
- **Probabilities**: Confidence percentages for each possible result
- **Stats**: Key metrics influencing the prediction

## üîç Model Limitations

- **Injuries/Suspensions**: Not accounted for in current model
- **Tactical Changes**: Manager/formation changes not tracked
- **Weather Conditions**: Not included in predictions
- **Motivation**: Derby/rivalry factors partially captured
- **Transfer Window**: New signings impact not immediately reflected

## üöÄ Future Enhancements

- [ ] Player-level statistics integration
- [ ] Injury/suspension tracking
- [ ] Weather data incorporation
- [ ] Head-to-head historical records
- [ ] Expected Goals (xG) integration
- [ ] Betting odds comparison
- [ ] Multi-league support

## üìà Validation & Backtesting

The model is continuously validated against:
- **Historical accuracy** on completed matches
- **Feature importance** analysis
- **Prediction calibration** (predicted vs actual probabilities)
- **Performance by match type** (home/away/neutral)

## ü§ù Contributing

Feel free to contribute improvements:
1. Enhanced feature engineering
2. Alternative ML algorithms
3. Real-time data integration
4. Performance optimizations
5. Additional leagues

## üìÑ License

This project is for educational and research purposes. Please comply with football-data.org's API terms of service.

## ‚ö†Ô∏è Disclaimer

**This model is for educational and entertainment purposes only. Sports betting involves risk and should be done responsibly. Past performance does not guarantee future results.**

---

### üìû Support

For questions or issues, please check:
- API documentation: [football-data.org](https://www.football-data.org/documentation)
- Model methodology in the source code comments
- Feature engineering details in the `create_focused_features()` function

---

**Last Updated**: September 27, 2025 at 10:35 UTC  
**Model Version**: 2.1  
**Dataset**: La Liga 2023-2025 seasons